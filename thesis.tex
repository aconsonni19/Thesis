\documentclass[12pt, a4paper, oneside]{report}
\usepackage[paper=a4paper,margin=1in]{geometry}
\usepackage{csquotes}
\usepackage[provide = *, italian]{babel}
\usepackage{graphicx} % allows inserting graphics
\usepackage{listings}
\usepackage{algpseudocode} % allows code snippets
\usepackage{algorithm}
\usepackage[hidelinks]{hyperref} % allows
\usepackage{subcaption} 
\usepackage[export]{adjustbox} 
\usepackage{wrapfig} % allows warped figures
\usepackage[acronym]{glossaries} % add glossary
\usepackage{acronym} % add acronyms
\usepackage{subfiles} % support multiple files
\usepackage{fancyhdr} % more control on headers and footers
\usepackage{xcolor}
\usepackage[
backend=biber,
style=ieee,
sorting=none,
]{biblatex}
\usepackage{ragged2e}
\usepackage{fancyhdr}
\usepackage{tikz}
\usepackage[normalem]{ulem}
\usepackage{array}
\usepackage{tabularx}
\usepackage[export]{adjustbox}
\usepackage{appendix}


\useunder{\uline}{\ul}{}
\usetikzlibrary{shapes.geometric, arrows.meta, positioning, fit, patterns}
\usetikzlibrary{calc}
\pagestyle{fancy} %oppure none
\fancyhf{}
\fancyhead[L]{\textit{Capitolo \thechapter}}
\fancyfoot{}
\fancyhead[R]{\textit{Pagina \thepage}}

\graphicspath{ {./images/} }

\addbibresource{./bibfile.bib}

%\includeonly{chapters/1-Introduzione}

\definecolor{codegreen}{rgb}{0,0.6,0}
\definecolor{codegray}{rgb}{0.5,0.5,0.5}
\definecolor{codepurple}{rgb}{0.58,0,0.82}
\definecolor{backcolour}{rgb}{0.95,0.95,0.92}


\lstdefinelanguage{JavaScript}{
  keywords={typeof, new, true, false, catch, function, return, null, catch, switch, var, if, in, while, do, else, case, break},
  keywordstyle=\color{blue}\bfseries,
  ndkeywords={class, export, boolean, throw, implements, import, this},
  ndkeywordstyle=\color{darkgray}\bfseries,
  identifierstyle=\color{black},
  sensitive=false,
  comment=[l]{//},
  morecomment=[s]{/*}{*/},
  commentstyle=\color{purple}\ttfamily,
  stringstyle=\color{red}\ttfamily,
  morestring=[b]',
  morestring=[b]"
}

\lstdefinestyle{mystyle}{
    backgroundcolor=\color{backcolour},   
    commentstyle=\color{codegreen},
    keywordstyle=\color{magenta},
    numberstyle=\tiny\color{codegray},
    stringstyle=\color{codepurple},
    basicstyle=\ttfamily\footnotesize,
    breakatwhitespace=false,         
    breaklines=true,                 
    captionpos=b,                    
    keepspaces=true,                 
    numbers=left,                    
    numbersep=5pt,                  
    showspaces=false,                
    showstringspaces=false,
    showtabs=false,                  
    tabsize=2
}

\lstset{style=mystyle}



\begin{document}
    \subfile{frontispiece.tex}
    \thispagestyle{empty}
    \vspace*{\fill}
    \vspace*{-4.5cm}
    \begin{Center}
        \begin{minipage}{\textwidth}
            \centering
            \itshape
            Vorrei esprimere i miei più sentiti ringraziamenti al \textbf{prof. Claudio Ferretti}, alla \textbf{Dott.sa Martina Saletta} e al \textbf{prof. Giovanni Denaro} per il costante supporto, la disponibilità e i preziosi consigli offerti durante tutto il percorso di tesi.
            \newline \vspace*{1.5em}
            Un ringraziamento speciale va alla \textbf{mia famiglia}, che con il suo supporto incondizionato mi ha permesso di affrontare con serenità questo percorso di studi. \newline \vspace*{1.5em}
            Sono profondamente grato anche \textbf{a tutti i miei amici}, il quale costante sostegno mi ha accompagnato e incoraggiato lungo tutto il percorso universitario
        \end{minipage}
    \end{Center}
    \vspace*{\fill}
    \newpage
    \clearpage
    % Abstract
    \thispagestyle{empty}
    \vspace*{\fill}
    \vspace*{-4cm}
    \begin{Center}
        \begin{minipage}{\textwidth}
            \centering
            \textbf{Abstract} \newline
            La sicurezza informatica è sempre più centrale nello sviluppo software, soprattutto quando si analizzano applicazioni senza accesso al codice sorgente. Questa tesi presenta Binoculars, una piattaforma web pensata per semplificare l’analisi di sicurezza di file binari ELF per architettura x86. Basata su angr, Flask e SvelteKit, la piattaforma offre un’interfaccia intuitiva che consente anche ad analisti non specialisti di effettuare una prima valutazione automatizzata, facilitando l’identificazione di potenziali vulnerabilità.
        \end{minipage}
    \end{Center}
    \vspace*{\fill}
    \addtocounter{page}{-2}

    \tableofcontents

    \thispagestyle{empty}
    \addtocounter{page}{-1}
    
    \listoffigures

    \lstlistoflistings

    \listoftables

    \thispagestyle{empty}
    \addtocounter{page}{-3}



    % Capitolo 1
    \subfile{chapters/1-Introduzione.tex}
    % Capitolo 2
    \subfile{chapters/2-stato_dell_arte.tex}
    % Capitolo 3
    \subfile{chapters/3-metodologia.tex}
    % Capitolo 4
    \subfile{chapters/4-tecnologie.tex}
    % Capitolo 5
    \subfile{chapters/5-analisi.tex}
    % Capitolo 6
    \subfile{chapters/6-implementazione.tex}
    \clearpage
    \fancypagestyle{bibliopage}{
        \fancyhf{}
        \fancyhead[R]{\textit{Pagina \thepage}}
        \fancyhead[L]{\textit{Bibliografia}} % oppure lascia vuoto se preferisci
    }
    \pagestyle{bibliopage}
    \printbibliography[heading=bibintoc]

    \clearpage
    \fancypagestyle{appendixA}{
        \fancyhf{}
        \fancyhead[R]{\textit{Pagina \thepage}}
        \fancyhead[L]{\textit{Appendice A}} % oppure lascia vuoto se preferisci
    }
    \pagestyle{appendixA}

    \begin{appendices}
        \chapter{Codice relativo al backend}
        Questa appendice contiene il codice sviluppato per il backend della piattaforma.
        \section{Server web}
        Il codice del server web è suddiviso nelle seguenti funzioni:
        \lstinputlisting[
            language=Python,
            caption={Enpoint \textit{/upload}},
            firstline = 29,
            lastline = 41
        ]{../Binoculars/backend/wsgi.py}


        \lstinputlisting[
            language=Python,
            caption={Endpoint \textit{/decompile}},
            firstline = 94,
            lastline = 117        
            ]{../Binoculars/backend/wsgi.py}

        \lstinputlisting[
            language=Python,
            caption={Endpoint \textit{/disassemble}},
            firstline = 47,
            lastline = 88        
            ]{../Binoculars/backend/wsgi.py}

        \newpage
        \lstinputlisting[
            language=Python,
            caption={Endpoint \textit{/analyses/vulndetect}},
            firstline = 123,
            lastline = 141]{../Binoculars/backend/wsgi.py}

        \lstinputlisting[
            language=Python,
            caption={Endpoint \textit{/analyses/arbiter}},
            firstline = 147,
            lastline = 179        ]{../Binoculars/backend/wsgi.py}

        \lstinputlisting[
            language=Python,
            caption={Funzione \textit{find\_vd\_files}},
            firstline = 184,
            lastline = 195        ]{../Binoculars/backend/wsgi.py}

        \lstinputlisting[
            language=Python,
            caption={Funzione \textit{save\_file}},
            firstline = 201,
            lastline = 211        ]{../Binoculars/backend/wsgi.py}

        \section{Classi wrapper per le analisi}
        Questa sezione contiene il codice delle classi wrapper che permettono l'accesso alle tecniche di analisi
        alla piattaforma.
        \subsection{VulnDetect}
        Come già trattato nel \textit{capitolo 3}, VulnDetect mantiene una lista di funzioni vulnerabili:
        \lstinputlisting[
            language=Python,
            lastline = 35,
            caption={Funzioni considerate potenzialmente pericolose da \protect\textit{VulnDetect}}
            ]{../Binoculars/backend/analyses/VulnDetection/VulnDetection.py}
        Il codice della classe wrapper per \textit{VulnDetect} può essere suddiviso nei seguenti metodi:
        \lstinputlisting[
            language=Python,
            firstline = 38,
            lastline = 64,
            caption={Metodo init della classe wrapper per \protect\textit{VulnDetect}}
            ]{../Binoculars/backend/analyses/VulnDetection/VulnDetection.py}
        \lstinputlisting[
            language=Python,
            firstline = 66,
            lastline = 106,
            caption={Metodo static\_analysis della classe wrapper per \protect\textit{VulnDetect}}
            ]{../Binoculars/backend/analyses/VulnDetection/VulnDetection.py}
        \newpage
        \lstinputlisting[
            language=Python,
            firstline = 108,
            lastline = 148,
            caption={Metodo vulnerability\_detection della classe wrapper per \protect\textit{VulnDetect}}
            ]{../Binoculars/backend/analyses/VulnDetection/VulnDetection.py}
        \newpage
        \lstinputlisting[
            language=Python,
            firstline = 151,
            caption={Metodo analyze della classe wrapper per \protect\textit{VulnDetect}}
            ]{../Binoculars/backend/analyses/VulnDetection/VulnDetection.py}

        \subsection{Arbiter}
        Il codice della classe wrapper per \textit{Arbiter} può essere suddiviso nei seguenti metodi:
        \lstinputlisting[
            language=Python,
            firstline = 6,
            lastline = 29,
            caption={Metodo init della classe wrapper per \protect\textit{Arbiter}}
            ]{../Binoculars/backend/analyses/arbiter/ArbiterAnalysis.py}
        \lstinputlisting[
            language=Python,
            firstline = 31,
            lastline = 49,
            caption={Metodo enable\_logging della classe wrapper per \protect\textit{Arbiter}}
            ]{../Binoculars/backend/analyses/arbiter/ArbiterAnalysis.py}
        \lstinputlisting[
            language=Python,
            firstline = 50,
            lastline = 92,
            caption={Metodo setup della classe wrapper per \protect\textit{Arbiter}}
            ]{../Binoculars/backend/analyses/arbiter/ArbiterAnalysis.py}
        \lstinputlisting[
            language=Python,
            firstline = 94,
            lastline = 118,
            caption={Metodo analyze della classe wrapper per \protect\textit{Arbiter}}
            ]{../Binoculars/backend/analyses/arbiter/ArbiterAnalysis.py}
    \end{appendices}
\end{document}